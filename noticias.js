let descripcion_dia_tierra = "En el Día de la Tierra, estamos orgullosos de compartir con ustedes la culminación de un hermoso proyecto en el Parque Sarmiento. Gracias a la colaboración entre la Fundación Forestatón, Kenility, la Secretaría de Ambiente y el Ente Bio Córdoba, hemos logrado un hito en nuestra misión de reforestar y preservar nuestro entorno natural. Plantamos especies nativas que no solo embellecen nuestro parque sino que también contribuyen a la biodiversidad local y al bienestar de nuestra comunidad. Este esfuerzo conjunto es un testimonio del poder de la colaboración entre los sectores público, privado y el tercer sector para efectuar un cambio positivo. Agradecemos a todos los voluntarios y colaboradores que se sumaron a esta noble causa. ¡Sigamos trabajando juntos por un planeta más verde y saludable!"
let noticia_dia_tierra = new Noticia(1, "img/dia_tierra.jpg", "Celebramos el dia de la Tierra", descripcion_dia_tierra, "Mayo 27, 2024");

let descripcion_dia_animal = "En la Fundación Forestatón estamos comprometidos con el cuidado del medio ambiente y de todas las especies que lo habitan. Por eso, en este Día del Animal queremos hacer un llamado a la reflexión y la acción. Sabemos que la conservación de la biodiversidad es fundamental para garantizar un futuro sostenible para todos. Es por eso que cada jornada de forestación que realizamos es un paso más hacia la protección de nuestro entorno y de las especies que lo componen. Este 29 de abril, te invitamos a sumarte a nuestra causa. ¡Cada gesto cuenta! Ya sea plantando un árbol, adoptando una mascota responsablemente o simplemente compartiendo información sobre la importancia de preservar la vida silvestre, todos podemos hacer nuestra parte."
let noticia_dia_animal = new Noticia(2, "img/dia_animal.png", "Celebremos juntos el Día del Animal", descripcion_dia_animal, "Abril 29, 2024");

let descripcion_forestaton = "¿Querés ser parte del cambio y ayudar a crear un futuro más verde?. Sumate a las próximas actividades de Forestatón y plantá un árbol con nosotros. Completá el formulario de contacto y te avisamos";
let noticia_forestaton = new Noticia(3, "img/forestaton_te_necesita.png", "¡Forestatón te necesita!", descripcion_forestaton, "Marzo 29, 2024" );

let descripcion_ciudades = "¿Sabías que las ciudades con mayor cantidad de árboles son las más felices? La forestación con especies nativas no solo transforma el paisaje urbano, sino que también trae consigo una gran cantidad de beneficios para la salud, el bienestar y el medio ambiente. Forestatón te invita a descubrir un mundo de posibilidades";
let noticia_ciudades = new Noticia(4, "img/ciudades_noticia.png", "Ciudades más verdes y vibrantes", descripcion_ciudades, "Enero 10, 2024");

let descripcion_causa_comun = "En Ciudad Universitaria, el legado de más de 400 años de la UNC se une al presente: la unión entre sectores público, académico, privado y tercer sector. Juntos, con la Secretaría de Políticas de Sustentabilidad de la UNC, voluntarios comprometidos, empresas y organizaciones, labramos un futuro sostenible para nuestra Casa Común. Gracias Germán Stroppa, Jona Palomeque, a los amigos de Forestando Córdoba y de Agenda Ambiental Córdoba.";
let noticia_causa_comun = new Noticia(5, "img/causa_comun.png", "Causa Común: Casa Común", descripcion_causa_comun, "Diciembre 9, 2023");

let descripcion_parque = "El Parque Francisco Tau es una reserva natural urbana ubicada en la ciudad de Bell Ville. Es el único bosque de la llanura cordobesa situado en el mismo centro de una ciudad, lo que le confiere un valor ecológico y patrimonial único. El parque se extiende sobre una superficie de 45 hectáreas y está rodeado por el río Ctalamochita. Su vegetación está compuesta por árboles autóctonos de la región, como algarrobos, talas, chañares, espinillos y moradillos. También alberga una gran variedad de fauna, incluyendo aves, reptiles, anfibios y mamíferos. El Parque Tau es un espacio fundamental para la conservación de la biodiversidad en la región. También es un lugar de recreación y esparcimiento para los habitantes de Bell Ville y sus visitantes.";
let noticia_parque = new Noticia(6, "img/parque.png", "Parque Francisco Tau", descripcion_parque, "Noviembre 25, 2023");

let descripcion_proyecto_carbono = "En Forestatón estamos comprometidos con la protección del medio ambiente. Por eso, en Semana 21 presentamos una innovadora iniciativa para que las empresas puedan reducir o neutralizar su huella de carbono plantando árboles nativos con nosotros. Nuestro proyecto consiste en brindar a las empresas o instituciones la oportunidad para que puedan calcular su huella de carbono y, a partir de ahí, diseñar un plan de compensación que incluya la plantación de árboles nativos de Córdoba junto a nuestra fundación. Creemos que esta iniciativa es una oportunidad para que las empresas se comprometan con la sostenibilidad y contribuyan a mitigar los efectos del cambio climático.";
let noticia_proyecto_carbono = new Noticia(7, "img/proyecto_carbono.png", "Participamos de Semana 21 con un proyecto para reducir la huella de carbono", descripcion_proyecto_carbono, "Octubre 30, 2023");

let descripcion_feria21 = "Estamos emocionados y honrados de ser parte de la prestigiosa #Feria21 de vinculación y oportunidades. En #Forestatón????, estamos sembrando raíces de cambio, tanto literal como figurativamente, al plantar árboles nativos en nuestras ciudades y contribuir a la remediación ambiental. ♻️ Creemos firmemente que la innovación es la clave para abordar los desafíos futuros en el sector productivo y social. Esperamos con ansias compartir nuestras experiencias, ideas creativas y enfoques para un mundo más sostenible en este evento inspirador ????.";
let noticia_feria21 = new Noticia(8, "img/feria21.png", "Forestatón en Feria21", descripcion_feria21, "Octubre 18, 2023");

let descripcion_incendio = "En los últimos días, nuestra comunidad se ha visto afectada por la devastación de los incendios forestales. Estos eventos, lamentablemente, no son nuevos en nuestro país, y la triste realidad es que la frecuencia y la magnitud de estos incendios están en aumento.  En los últimos días, nuestra comunidad se ha visto afectada por la devastación de los incendios forestales. Estos eventos, lamentablemente, no son nuevos en nuestro país, y la triste realidad es que la frecuencia y la magnitud de estos incendios están en aumento.";
let noticia_incendio = new Noticia(9, "img/incendio.png", "Otra vez los incendios forestales son noticia: Un llamado a la acción", descripcion_incendio, "Octubre 11, 2023")

let noticias = [];
noticias.push(noticia_dia_tierra);
noticias.push(noticia_dia_animal);
noticias.push(noticia_forestaton);
noticias.push(noticia_ciudades);
noticias.push(noticia_causa_comun);
noticias.push(noticia_parque);
noticias.push(noticia_proyecto_carbono);
noticias.push(noticia_feria21);
noticias.push(noticia_incendio);


function main() {
    mostrarNoticias(noticias);
    const contenedor = document.getElementById('lista_noticias');
            const inputBusqueda = document.getElementById('buscador_noticia');
            inputBusqueda.addEventListener('input', function() {
                const terminoBusqueda = inputBusqueda.value.toLowerCase();
                const noticiasFiltradas = noticias.filter(noticia => 
                    noticia.titulo.toLowerCase().includes(terminoBusqueda)
                );
                if(noticiasFiltradas.length == 0){
                   contenedor.innerHTML = '<h1 class="error_noticia">No se encontro la noticia!</h1>';
                }
                else{
                    mostrarNoticias(noticiasFiltradas);
                }
               
            });
}

function mostrarNoticias(noticiasFiltradas) {
    const contenedor = document.getElementById('lista_noticias');
    noticiasFiltradas.sort((a, b) => new Date(b.fecha) - new Date(a.fecha));
    contenedor.innerHTML = '';
    noticiasFiltradas.forEach(noticia => {
        const noticiaHTML = `
            <div class="noticia">
                <div class="img_noticia">
                    <img src="${noticia.ruta_img}" alt="">
                </div>
                <div class="contenido_noticia">
                    <div class="titulo_noticia"><h1>${noticia.titulo}</h1></div>
                    <div class="resumen_noticia"><h1>${noticia.descripcion_breve}</h1></div>
                    <a href="noticia.html?id=${noticia.id}" class="leer_mas">Leer más</a>
                    <h2 class="fecha_noticia"><i class="fa-solid fa-calendar-days"></i>${noticia.fecha}</h2>
                </div>
            </div>
        `;
        contenedor.innerHTML += noticiaHTML;
    });
}


//document.addEventListener('DOMContentLoaded', main);

//Detalle Noticia
function obtenerNoticiaPorId(id) {
    return noticias.find(noticia => noticia.id == id);
}

/*function mostrarDetalleNoticia(noticia) {
    const contenedor = document.getElementById('noticia_detalle');
    if (noticia) {
        const noticiaHTML = `
            <div class="noticia_detalles">
                <div class="noticias_titulo">${noticia.titulo}</div>
                <div class="img_noticia">
                    <img src="${noticia.ruta_img}" alt="">
                </div>
                <div class="resumen_noticia"><h1>${noticia.descripcion}</h1></div>
            </div>
        `;
        contenedor.innerHTML = noticiaHTML;
    } else {
        contenedor.innerHTML = "<p>Noticia no encontrada</p>";
    }
}*/

function mostrarDetalleNoticia(noticia) {
    const contenedor = document.getElementById('noticia_detalle');
    if (noticia) {
        const descripcionPartes = noticia.descripcion.split('.').map(parte => parte.trim()).filter(parte => parte.length > 0);
        const descripcionHTML = descripcionPartes.map(parte => `<p>${parte}.</p>`).join('');

        const noticiaHTML = `
              <div class="noticia_detalles">
                <div class="noticias_titulo">${noticia.titulo}</div>
                <div class="noticia_header">
                <h2 class="fecha_noticia"><i class="fa-regular fa-user"></i>Por Fundación ONG</h2>
                <h2 class="fecha_noticia"><i class="fa-solid fa-calendar-days"></i>${noticia.fecha}</h2>
                <h2 class="fecha_noticia"><i class="fa-solid fa-comment"></i>Sin comentarios</h2>
                </div>
                <div class="img_noticia">
                    <img src="${noticia.ruta_img}" alt="">
                </div>
                <div class="resumen_noticia"><h1>${descripcionHTML}</h1></div>
            </div>
        `;
        contenedor.innerHTML = noticiaHTML;
    } else {
        contenedor.innerHTML = "<p>Noticia no encontrada</p>";
    }
}

function detalle() {
    const params = new URLSearchParams(window.location.search);
    
    let idNoticia = params.get('id');
    console.log(idNoticia);
    if(idNoticia === null){
        idNoticia = 1;
    }
    const noticia = obtenerNoticiaPorId(idNoticia);
    mostrarDetalleNoticia(noticia);
}

document.getElementById("agregarNoticia").addEventListener('click', () => {
    document.getElementById("modal_noticias").style.display = "block";
    document.querySelector('.dark').style.display = 'block';
});

document.querySelector(".close").addEventListener('click', () => {
    document.getElementById("modal_noticias").style.display = "none";
    document.querySelector('.dark').style.display = 'none';
});

document.getElementById("formAgregarNoticia").addEventListener('submit', (e) => {
    e.preventDefault();

    const titulo = document.getElementById("titulo").value;
    const imagen = document.getElementById("imagen").value;
    const descripcion = document.getElementById("descripcion").value;
    let fecha = document.getElementById("fecha").value;
    fecha = convertirFecha(fecha);

    let id = noticias.length ? noticias[noticias.length - 1].id + 1 : 1;
    let nuevaNoticia = new Noticia(id, imagen, titulo, descripcion, fecha);
    noticias.push(nuevaNoticia);

    document.getElementById("modal_noticias").style.display = "none";
    document.querySelector('.dark').style.display = 'none';
    main();
});

function convertirFecha(fecha) {
    const meses = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
    let [year, month, day] = fecha.split("-");
    month = meses[parseInt(month) - 1];
    return ` ${month} ${parseInt(day)}, ${year}`;
}

